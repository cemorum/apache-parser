# apache-parser

Apache-parser - это графическое приложение на базе PyQt5 и Flask REST API для просмотра и анализа логов сделанное студентом Ильей Костюковым в рамках учебной практики колледжа IThub.

## Установка

1. Склонируйте репозиторий проекта:

    ```
    git clone https://github.com/cemorum/apache-parser.git
    ```

2. Установите зависимости проекта:

    ```
    pip install -r requirements.txt
    ```

3. Отредактируйте файл `config.json` и файл 'config.ini', указав параметры подключения к базе данных и путь к файлу журнала.

## Запуск

1. Запустите приложение для просмотра логов:

    ```
    python app.py
    ```

2. Запустите Flask API:

    ```
    python api.py
    ```

## Как использовать приложение

1. **Парсинг**: Нажмите кнопку "Parse" для разбора файла логов и сохранения его содержимого в базу данных. 
2. **Просмотр логов**: Чтобы просмотреть все логи из базы данных, нажмите кнопку "Show Logs".
3. **Фильтрация**: Чтобы отфильтровать логи по IP или дате, выберите соответствующие флажки и нажмите кнопку "Filter". Если вы хотите фильтровать по диапазону дат, выберите флажок "Date Range" и введите начальную и конечную дату.
4. **Планирование задач(cron)**: Чтобы запланировать задачу на ежедневный парсинг логов, нажмите кнопку "Cron" и введите время выполнения задачи. (на windows 10 в планировщике задач выберите найстройку для windows 10 иначе скрипт не сработает)

## REST API

API предоставляет следующие эндпоинты:

- `GET /logs`: Получить все логи.
- `GET /logs/count`: Получить количество логов.
- `GET /logs/date/<date>`: Получить количество логов за указанную дату.
- `GET /logs/date_range?start=<start_date>&end=<end_date>`: Получить логи за указанный диапазон дат.

### Использование API

Вы можете использовать следующую команду CURL для обращения к API:

```bash
curl -H "x-api-key: your-api-key" "http://localhost:5000/logs?group_by_ip=true&group_by_date=true&start_date=2023-10-05&end_date=2023-10-10" 
в данном случае вместо your-api-key нужно указать ваш API ключ (API ключ нужно придумать самому и написать в файле api.py), также можете указать нужные параметры фильтрации, такие как: group_by_ip, group_by_date, start_date/end_date (указать нужный диапазон дат для фильтрации)



